<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Lens - Groq 70B</title>
<style>
    body { font-family: sans-serif; margin: 20px; background: #f7f7f7; }
    input, textarea, button { width: 100%; margin: 5px 0; padding: 10px; font-size: 16px; }
    .category-section { background: #fff; padding: 15px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .category-section h3 { margin: 0 0 10px 0; color: #333; }
    .category-section p { margin: 0; white-space: pre-wrap; }
</style>
</head>
<body>

<h2>Smart Lens - Groq 70B</h2>

<textarea id="userInput" placeholder="Enter multiple lines, one per question..." rows="6"></textarea>
<button onclick="processInputs()">Submit</button>

<div id="output"></div>

<script>
const API_KEY = "YOUR_API_KEY"; // Change to your Grow API Key
const API_URL = "https://api.grow.com/v1/responses";

// Detect category
function detectCategory(inputText) {
    if (/[\u0A80-\u0AFF]/.test(inputText)) return "શિલાલેખ ભાષાંતર";
    if (/\d/.test(inputText)) return "Maths";
    if (/physics|chemistry|biology/i.test(inputText)) return "Science";
    if (/history|ancient|medieval/i.test(inputText)) return "History";
    if (/grammar|language/i.test(inputText)) return "Language / Grammar";
    return "General";
}

// Prompts per category
const promptMap = {
    "શિલાલેખ ભાષાંતર": "Translate this inscription text to modern Gujarati: ",
    "Maths": "Solve the following math problem step by step: ",
    "Science": "Explain scientifically: ",
    "History": "Provide historical context for: ",
    "Language / Grammar": "Check grammar, explain, and correct: ",
    "General": "Answer this: "
};

// Call Groq 70B API
async function callGroq70B(userInput) {
    const category = detectCategory(userInput);
    const prompt = promptMap[category] + userInput;

    try {
        const response = await fetch(API_URL, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${API_KEY}`
            },
            body: JSON.stringify({
                model: "groq-70b",
                prompt: prompt,
                max_output_tokens: 512,
                temperature: 0.7
            })
        });

        if (!response.ok) {
            const errText = await response.text();
            throw new Error(`API Error: ${errText}`);
        }

        const data = await response.json();
        return { category, response: data.output?.[0]?.content || "No response from Groq 70B" };

    } catch (err) {
        console.error("Groq 70B API Error:", err);
        return { category, response: "Error: Unable to get response" };
    }
}

// Process multiple inputs
async function processInputs() {
    const rawInput = document.getElementById("userInput").value.trim();
    if (!rawInput) return alert("Please enter at least one input.");

    const lines = rawInput.split("\n").filter(l => l.trim() !== "");
    const outputDiv = document.getElementById("output");
    outputDiv.innerHTML = "";

    // Loop through inputs
    for (const line of lines) {
        const result = await callGroq70B(line);

        // Create category section
        const section = document.createElement("div");
        section.className = "category-section";
        section.innerHTML = `<h3>${result.category}</h3><p>${result.response}</p>`;
        outputDiv.appendChild(section);
    }
}
</script>

</body>
</html>
